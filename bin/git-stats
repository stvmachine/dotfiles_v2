#!/usr/bin/env fish
#
# Shows your contribution statistics for the last 30 days.
# Based on https://twitter.com/thorstenball/status/1293181225280999431
#
# Examples
#
#   git stats

if contains -- --help $argv; or contains -- -h $argv
    echo "Usage: git stats"
    echo ""
    echo "Shows your contribution statistics for the last 30 days."
    echo "Displays lines added (green), lines removed (red), and net total."
    echo ""
    echo "Examples:"
    echo "  git stats   # Show your 30-day contribution stats"
    exit 0
end

git log \
	--since '30 days ago' \
	--author (git config --global user.name) \
	--pretty=tformat: --numstat |
		awk '{
			add += $1; subs += $2; loc += $1 - $2
		} END {
			printf "Lines: +\033[32m%s\033[0m -\033[31m%s\033[0m\nTotal: %s\n", add, subs, loc
		}'
