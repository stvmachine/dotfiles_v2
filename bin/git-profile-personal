#!/usr/bin/env fish

# Switch to personal git profile (stvmachine)
# Updates remotes to use personal SSH key (github-personal)

git config --local user.name "stvmachine"
git config --local user.email "campos.esteban@gmail.com"

# Update existing remotes to use personal SSH key (github-personal)
for remote in (git remote)
	set remote_url (git remote get-url $remote)
	
	# Handle SSH URLs: git@github.com:user/repo -> git@github-personal:user/repo
	if string match -q "git@github.com:*" $remote_url
		set new_url (string replace "git@github.com:" "git@github-personal:" $remote_url)
		git remote set-url $remote $new_url
		echo "Updated remote '$remote': $new_url"
	# Handle HTTPS URLs: https://github.com/user/repo -> git@github-personal:user/repo
	else if string match -q "https://github.com/*" $remote_url
		set repo_path (string replace "https://github.com/" "" $remote_url)
		set new_url "git@github-personal:$repo_path"
		git remote set-url $remote $new_url
		echo "Updated remote '$remote': $new_url (converted HTTPS to SSH)"
	# Skip if already using github-personal
	else if string match -q "*github-personal*" $remote_url
		echo "Remote '$remote' already uses github-personal"
	end
end

echo "Switched to personal git profile: stvmachine <campos.esteban@gmail.com>"
